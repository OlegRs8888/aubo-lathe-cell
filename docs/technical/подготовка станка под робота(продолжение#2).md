
***

## 1. Функции и общая логика

- Система на базе PLC Delta DVP12SE11R управляет пневматическими дверями и тисками двухзонного 5‑осевого станка,
  опрашивает дверные датчики, светофор станка и ручной пост, обменивается командами/статусами с роботом по Modbus TCP.
- Основные функции:
    - автоматическое открытие/закрытие дверей по запросу станка/робота и с поста;
    - зажим/разжим левых и правых тисков;
    - межблокировки безопасности: разрешение цикла только при закрытых дверях, зажатых тисках и отсутствии аварий;
    - имитация нажатия «Start» на станке при выполнении условий;
    - индикация режимов/состояний через подсветку кнопок и светофор станка.

***

## 2. Структура PLC и распределение I/O

### 2.1. Состав PLC

- CPU: Delta **DVP12SE11R** — 8 DI, 4 DO (реле), 24 V DC, Ethernet (Modbus TCP/EtherNet/IP), 2×RS‑485.
- Расширения справа:
    - **DVP16SP11R \#1** — 8 DI, 8 DO (релейные).
    - **DVP16SP11R \#2** — 8 DI, 8 DO (релейные).
    - **DVP08SP11R** — 4 DI, 4 DO (релейные).


### 2.2. Логика распределения сигналов

- Входы CPU (DVP12SE11R):
    - X0–X4: MCODE_200…204 — 5 пользовательских М‑кодов со штатного PLC станка (отдельные жилы B1…B5).
    - X5: Door_L_Closed — левая дверь закрыта.
    - X6: Door_L_Open — левая дверь открыта.
    - X7: Door_R_Closed — правая дверь закрыта.
- Входы DVP16SP11R \#1:
    - X0: PB_DOOR_OPEN.
    - X1: PB_DOOR_CLOSE.
    - X2: PB_DOOR_RELAX.
    - X3: PB_ZONE_L_EN.
    - X4: PB_ZONE_R_EN.
    - X5: PB_CLAMP_LEFT.
    - X6: PB_CLAMP_RIGHT.
    - X7: Door_R_Open — правая дверь открыта.
- Входы DVP16SP11R \#2:
    - X0–X7: резерв/будущие датчики (например, датчики тисков).
- Входы DVP08SP11R:
    - X0: CNC_STACKLIGHT_RED.
    - X1: CNC_STACKLIGHT_YELLOW.
    - X2: CNC_STACKLIGHT_GREEN.
    - X3: резерв.
- Выходы CPU DVP12SE11R:
    - Y0–Y3: не используются (резерв).
- Выходы DVP16SP11R \#1 (подсветка и 1 резервный DO):
    - Y0: LED_DOOR_OPEN.
    - Y1: LED_DOOR_CLOSE.
    - Y2: LED_DOOR_RELAX.
    - Y3: LED_ZONE_L_EN.
    - Y4: LED_ZONE_R_EN.
    - Y5: LED_CLAMP_LEFT.
    - Y6: LED_CLAMP_RIGHT.
    - Y7: VALVE_X_COIL / резерв.
- Выходы DVP16SP11R \#2 (катушки распределителей через FLEXICORE 12G0.5):
    - Y0: COIL_LINE_W1 → жила 1.
    - Y1: COIL_LINE_W3 → жила 3.
    - Y2: COIL_LINE_W5 → жила 5.
    - Y3: COIL_LINE_W7 → жила 7.
    - Y4: COIL_LINE_W9 → жила 9.
    - Y5: COIL_LINE_W11 → жила 11.
    - Y6–Y7: резерв.
- Выходы DVP08SP11R:
    - Y0: VALVE_3_COIL (одна из катушек клапана дверей).
    - Y1: CNC_START_RELAY — замыкание контакта кнопки «Start» станка.
    - Y2–Y3: резерв.

***

## 3. Modbus‑карта для робота

Используется Modbus TCP, где:

- Discrete Inputs (функция 02) → область RX, база `0x0400`.
- Coils (функция 01/05/15) → область RY, база `0x0500`.


### 3.1. Входы (X → Discrete Inputs)

| Сигнал | Модуль | X | N | Modbus |
| :-- | :-- | :-- | :-- | :-- |
| MCODE_200 | CPU | X0 | 0 | 0x0400 |
| MCODE_201 | CPU | X1 | 1 | 0x0401 |
| MCODE_202 | CPU | X2 | 2 | 0x0402 |
| MCODE_203 | CPU | X3 | 3 | 0x0403 |
| MCODE_204 | CPU | X4 | 4 | 0x0404 |
| Door_L_Closed | CPU | X5 | 5 | 0x0405 |
| Door_L_Open | CPU | X6 | 6 | 0x0406 |
| Door_R_Closed | CPU | X7 | 7 | 0x0407 |
| PB_DOOR_OPEN | DVP16SP\#1 | X0 | 8 | 0x0408 |
| PB_DOOR_CLOSE | DVP16SP\#1 | X1 | 9 | 0x0409 |
| PB_DOOR_RELAX | DVP16SP\#1 | X2 | 10 | 0x040A |
| PB_ZONE_L_EN | DVP16SP\#1 | X3 | 11 | 0x040B |
| PB_ZONE_R_EN | DVP16SP\#1 | X4 | 12 | 0x040C |
| PB_CLAMP_LEFT | DVP16SP\#1 | X5 | 13 | 0x040D |
| PB_CLAMP_RIGHT | DVP16SP\#1 | X6 | 14 | 0x040E |
| Door_R_Open | DVP16SP\#1 | X7 | 15 | 0x040F |
| FREE_0…FREE_7 | DVP16SP\#2 | X0–X7 | 16–23 | 0x0410–0x0417 |
| CNC_STACKLIGHT_RED | DVP08SP | X0 | 24 | 0x0418 |
| CNC_STACKLIGHT_YELLOW | DVP08SP | X1 | 25 | 0x0419 |
| CNC_STACKLIGHT_GREEN | DVP08SP | X2 | 26 | 0x041A |
| FREE_8 | DVP08SP | X3 | 27 | 0x041B |

### 3.2. Выходы (Y → Coils)

| Сигнал | Модуль | Y | M | Modbus |
| :-- | :-- | :-- | :-- | :-- |
| CPU_Y0_UNUSED | CPU | Y0 | 0 | 0x0500 |
| CPU_Y1_UNUSED | CPU | Y1 | 1 | 0x0501 |
| CPU_Y2_UNUSED | CPU | Y2 | 2 | 0x0502 |
| CPU_Y3_UNUSED | CPU | Y3 | 3 | 0x0503 |
| LED_DOOR_OPEN | DVP16SP\#1 | Y0 | 4 | 0x0504 |
| LED_DOOR_CLOSE | DVP16SP\#1 | Y1 | 5 | 0x0505 |
| LED_DOOR_RELAX | DVP16SP\#1 | Y2 | 6 | 0x0506 |
| LED_ZONE_L_EN | DVP16SP\#1 | Y3 | 7 | 0x0507 |
| LED_ZONE_R_EN | DVP16SP\#1 | Y4 | 8 | 0x0508 |
| LED_CLAMP_LEFT | DVP16SP\#1 | Y5 | 9 | 0x0509 |
| LED_CLAMP_RIGHT | DVP16SP\#1 | Y6 | 10 | 0x050A |
| VALVE_X_COIL / резерв | DVP16SP\#1 | Y7 | 11 | 0x050B |
| COIL_LINE_W1 (жила 1) | DVP16SP\#2 | Y0 | 12 | 0x050C |
| COIL_LINE_W3 (жила 3) | DVP16SP\#2 | Y1 | 13 | 0x050D |
| COIL_LINE_W5 (жила 5) | DVP16SP\#2 | Y2 | 14 | 0x050E |
| COIL_LINE_W7 (жила 7) | DVP16SP\#2 | Y3 | 15 | 0x050F |
| COIL_LINE_W9 (жила 9) | DVP16SP\#2 | Y4 | 16 | 0x0510 |
| COIL_LINE_W11 (жила 11) | DVP16SP\#2 | Y5 | 17 | 0x0511 |
| FREE_9, FREE_10 | DVP16SP\#2 | Y6–Y7 | 18–19 | 0x0512–0x0513 |
| VALVE_3_COIL (двери) | DVP08SP | Y0 | 20 | 0x0514 |
| CNC_START_RELAY | DVP08SP | Y1 | 21 | 0x0515 |
| FREE_11, FREE_12 | DVP08SP | Y2–Y3 | 22–23 | 0x0516–0x0517 |


***

## 4. Пневматика, датчики и нумерация жил

### 4.1. Распределители и логика

- Правые тиски: E.MC **RV5322C‑08E4**, 5/3 центр закрытый, клапан YV10 (верхний, ближе к стенке шкафа).
- Левые тиски: E.MC **RV5322C‑08E4**, клапан YV11 (верхний, второй слой).
- Двери: E.MC **RV5322E‑08E4**, 5/3 центр на выхлоп, клапан YV12 (нижний, на стенке шкафа).

Катушки всех трёх клапанов питаются через кабель FLEXICORE 12G0.5 от выходов DVP16SP\#2 и DVP08SP, общий 0 V — объединённые 
чётные жилы + N.

### 4.2. Датчики дверей

- SICK **RZT7** P/N 1070853, магнитный цилиндровый датчик для Т‑паза, выход NO, 5–30 V DC, 2‑проводное подключение, кабель 5 м.
- Коричневый провод всех датчиков: объединён, идёт на +24 V через жилы 76 (левая дверь) и 86 (правая дверь).
- Синий провод каждого датчика:
    - Левая дверь: на жилы 74 (Door_L_Closed → X5 CPU) и 75 (Door_L_Open → X6 CPU).
    - Правая дверь: на жилы 84 (Door_R_Closed → X7 CPU) и 85 (Door_R_Open → X7 DVP16SP\#1).


### 4.3. Нумерация и назначение жил кабелей

**FLEXICORE 110 12G0.5 (клапаны)**

- 12×0,5 мм², жила 1–11 чёрные, 12‑я — жёлто‑зелёная N.
- Жилы 1,3,5,7,9,11 — плюсы катушек от DO DVP16SP\#2 (COIL_LINE_W1…W11).
- Жилы 2,4,6,8,10,N — все объединены и посажены на 0 V (возврат катушек).

**YSLY‑JZ 5×0,5 мм², левый борт (74–78)**

- 76 — общий +24 V для левых дверных датчиков (коричневые).
- 74 — синий «Door_L_Closed» → X5 CPU.
- 75 — синий «Door_L_Open» → X6 CPU.
- 77–78 — резерв/доп. сигналы.

**YSLY‑JZ 5×0,5 мм², правый борт (84–88)**

- 86 — общий +24 V для правых дверных датчиков.
- 84 — «Door_R_Closed» → X7 CPU.
- 85 — «Door_R_Open» → X7 DVP16SP\#1.
- 87–88 — резерв.

**Два КВВГ 10×0,5 мм²**

- Кабель \#1: жилы 20–29 → правый борт, универсальные контрольные цепи.
- Кабель \#2: жилы 30–39 → правый борт, дополнительные цепи.

**Отдельные жилы М‑кодов**

- B1…B5, 0,5 мм², идут от выходов штатного PLC станка до X0–X4 DVP12SE11R (MCODE_200…204).

***

## 5. Спецификация основных компонентов

- **PLC и I/O**
    - Delta DVP12SE11R — CPU, 8 DI / 4 DO, 24 V DC, Ethernet, Modbus TCP/EtherNet/IP, 2×RS‑485.
    - Delta DVP16SP11R — 2 шт, 8 DI / 8 DO (реле), 24 V DC.
    - Delta DVP08SP11R — 4 DI / 4 DO (реле), 24 V DC.
- **Пневматика**
    - E.MC RV5322C‑08E4 — 5/3, центр закрытый, G1/4, катушки 24 V DC (тиски, 2 шт).
    - E.MC RV5322E‑08E4 — 5/3, центр на выхлоп, G1/4, катушки 24 V DC (двери).
    - EAW2000‑02F25M — фильтр‑регулятор G1/4, 0,5–9 бар, 5 мкм (2 шт: двери и тиски).
    - EAL2000‑02 — маслораспылитель G1/4 (2 шт).
- **Датчики**
    - SICK RZT7 P/N 1070853 — цилиндровый магнитный датчик, NO, 5–30 V DC, 2‑проводной, кабель 5 м, LED.
- **Кабели**
    - FLEXICORE 110 12G0.5 — 12×0,5 мм², гибкий управляющий кабель катушек.
    - YSLY‑JZ 5×0,5 мм² — по одному на левый (74–78) и правый (84–88) борта.
    - КВВГ 10×0,5 мм² — 2 шт, жилы 20–29 и 30–39.
    - Отдельные жилы 0,5 мм² B1…B5 — М‑коды.
    - Ethernet Cat5e/Cat6 — Modbus TCP PLC ↔ робот.
